/*
 * This file is dual-licensed: you can use it either under the terms
 * of the GPL or the X11 license, at your option. Note that this dual
 * licensing only applies to this file, and not this project as a
 * whole.
 *
 *  a) This file is free software; you can redistribute it and/or
 *     modify it under the terms of the GNU General Public License as
 *     published by the Free Software Foundation; either version 2 of the
 *     License, or (at your option) any later version.
 *
 *     This file is distributed in the hope that it will be useful,
 *     but WITHOUT ANY WARRANTY; without even the implied warranty of
 *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *     GNU General Public License for more details.
 *
 * Or, alternatively,
 *
 *  b) Permission is hereby granted, free of charge, to any person
 *     obtaining a copy of this software and associated documentation
 *     files (the "Software"), to deal in the Software without
 *     restriction, including without limitation the rights to use,
 *     copy, modify, merge, publish, distribute, sublicense, and/or
 *     sell copies of the Software, and to permit persons to whom the
 *     Software is furnished to do so, subject to the following
 *     conditions:
 *
 *     The above copyright notice and this permission notice shall be
 *     included in all copies or substantial portions of the Software.
 *
 *     THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 *     EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 *     OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 *     NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 *     HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 *     WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 *     FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 *     OTHER DEALINGS IN THE SOFTWARE.
 */

/dts-v1/;

#include <dt-bindings/pwm/pwm.h>
#include <dt-bindings/input/input.h>
#include <dt-bindings/display/rk_fb.h>
#include <dt-bindings/display/media-bus-format.h>

#include "rk3288.dtsi"
#include "rk3288-linux.dtsi"

// edp panel
#include <dt-bindings/display/screen-timing/lcd-ch7525a.dtsi>



/ {
	compatible = "rockchip,rk3288-ebcrb03-a2", "rockchip,rk3288";
	model = "EBC-RB03 a102-1";

	chosen {
		bootargs = "earlyprintk console=ttyFIQ0 rw root=PARTUUID=614e0000-0000 rootfstype=ext4 rootwait";
	};
	
	fiq-debugger {
		status = "okay";
	};
	
	gpio-keys {
		compatible = "gpio-keys";
		#address-cells = <1>;
		#size-cells = <0>;
		autorepeat;

		pinctrl-names = "default";
		pinctrl-0 = <&pmic_pwr>;

		button@0 {
			gpios = <&gpio0 RK_PA5 GPIO_ACTIVE_LOW>;
			linux,code = <116>;
			label = "GPIO Key Power";
			linux,input-type = <1>;
			gpio-key,wakeup = <1>;
			debounce-interval = <100>;
		};
	};

	sdio_pwrseq: sdio-pwrseq {
		compatible = "mmc-pwrseq-simple";
		pinctrl-names = "default";
		pinctrl-0 = <&wifi_enable_h>;

		/*
		 * On the module itself this is one of these (depending
		 * on the actual card populated):
		 * - SDIO_RESET_L_WL_REG_ON
		 * - PDN (power down when low)
		 */
		reset-gpios = <&gpio5 18 GPIO_ACTIVE_LOW>;
	};

    wireless-wlan {
		compatible = "wlan-platdata";
		rockchip,grf = <&grf>;
		wifi_chip_type = "rtl8723bs";
		sdio_vref = <3300>;
		//keep_wifi_power_on = <1>;
		pinctrl-names = "default";
		pinctrl-0 = <&wifi_pwr_h>;
		//pinctrl-1 = <&wifi_enable_h>;
		WIFI,host_wake_irq = <&gpio4 RK_PD2 GPIO_ACTIVE_HIGH>; // WIFI_WAKE_HOST
		WIFI,poweren_gpio = <&gpio4 RK_PD4 GPIO_ACTIVE_HIGH>;
		//WIFI,reset_gpio = <&gpio5 RK_PC2 GPIO_ACTIVE_HIGH>;
		status = "okay";
    };

	wireless-bluetooth {
        compatible = "bluetooth-platdata";
        uart_rts_gpios = <&gpio4 RK_PC3 GPIO_ACTIVE_LOW>;
        pinctrl-names = "default", "rts_gpio";
        pinctrl-0 = <&uart0_rts &bt_pwr_h>;
        pinctrl-1 = <&uart0_rts_gpio &bt_pwr_h>;
        BT,power_gpio = <&gpio5 RK_PC1 GPIO_ACTIVE_HIGH>;
        //BT,reset_gpio    = <&gpio4 29 GPIO_ACTIVE_HIGH>;
        //BT,wake_gpio     = <&gpio4 26 GPIO_ACTIVE_HIGH>;
        //BT,wake_host_irq = <&gpio4 31 GPIO_ACTIVE_HIGH>;
        status = "okay";
	};

	rockchip-rt5660 {
		compatible = "rockchip,rockchip-audio-rt5660";
		rockchip,model = "rockchip_rt5660";
        rockchip,i2s-controller = <&i2s>;
        rockchip,audio-codec = <&rt5660>;
	};

	dwc_control_usb: dwc-control-usb@ff770284 {
		compatible = "rockchip,rk3288-dwc-control-usb";
		status = "okay";
		pinctrl-names = "default";
		pinctrl-0 = <&host_vbus_drv &otg_vbus_drv>;
		reg = <0x0 0xff770284 0x0 0x04>, <0x0 0xff770288 0x0 0x04>,
		      <0x0 0xff7702cc 0x0 0x04>, <0x0 0xff7702d4 0x0 0x04>,
		      <0x0 0xff770320 0x0 0x14>, <0x0 0xff770334 0x0 0x14>,
		      <0x0 0xff770348 0x0 0x10>, <0x0 0xff770358 0x0 0x08>,
		      <0x0 0xff770360 0x0 0x08>;
		reg-names = "GRF_SOC_STATUS1" ,"GRF_SOC_STATUS2",
			    "GRF_SOC_STATUS19", "GRF_SOC_STATUS21",
			    "GRF_UOC0_BASE", "GRF_UOC1_BASE",
			    "GRF_UOC2_BASE", "GRF_UOC3_BASE",
			    "GRF_UOC4_BASE";
		interrupts = <GIC_SPI 93 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 94 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 95 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 96 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 97 IRQ_TYPE_LEVEL_HIGH>;
		interrupt-names = "otg_id", "otg_bvalid",
				  "otg_linestate", "host0_linestate",
				  "host1_linestate";
		clocks = <&cru HCLK_USB_PERI>;
		clock-names = "hclk_usb_peri";

		otg_drv_gpio = <&gpio0 12 GPIO_ACTIVE_LOW>;
		host_drv_gpio = <&gpio0 14 GPIO_ACTIVE_LOW>;
		rockchip,remote_wakeup;
		rockchip,usb_irq_wakeup;

		usb_bc {
			compatible = "synopsys,phy";
			rk_usb,bvalid     = <0x288 14 1>;
			rk_usb,iddig      = <0x288 17 1>;
			rk_usb,dcdenb     = <0x328 14 1>;
			rk_usb,vdatsrcenb = <0x328  7 1>;
			rk_usb,vdatdetenb = <0x328  6 1>;
			rk_usb,chrgsel    = <0x328  5 1>;
			rk_usb,chgdet     = <0x2cc 23 1>;
			rk_usb,fsvminus   = <0x2cc 25 1>;
			rk_usb,fsvplus    = <0x2cc 24 1>;
		};
		
		usb_uart {
			status = "disabled";
		};
	};

	edp_panel {
		compatible = "simple-panel";
		status = "okay";
		panel_type = <SCREEN_EDP>;
		display-timings = <&disp_timings>;
		
		ports {
			panel_in_edp: endpoint {
				remote-endpoint = <&edp_out_panel>;
			};
		};
	};

	xin32k: xin32k {
		compatible = "fixed-clock";
		clock-frequency = <32768>;
		clock-output-names = "xin32k";
		#clock-cells = <0>;
	};
	
	ext_gmac: external-gmac-clock {
		compatible = "fixed-clock";
		clock-frequency = <125000000>;
		clock-output-names = "ext_gmac";
		#clock-cells = <0>;
	};

	vcc_sys: vsys-regulator {
		compatible = "regulator-fixed";
		regulator-name = "vcc_sys";
		regulator-min-microvolt = <5000000>;
		regulator-max-microvolt = <5000000>;
		regulator-always-on;
		regulator-boot-on;
	};

	vdd_log: vdd-logic {
		compatible = "regulator-fixed";
		regulator-name = "vcc_log";
		regulator-min-microvolt = <1150000>;
		regulator-max-microvolt = <1150000>;
		regulator-always-on;
		regulator-boot-on;
	};

	vcc_flash: vdd-logic-regulator {
		compatible = "regulator-fixed";
		regulator-name = "vcc_flash";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		regulator-always-on;
		regulator-boot-on;
	};

	vcc_phyio: vcc-phy-regulator {
		compatible = "regulator-fixed";
		regulator-name = "vcc_phyio";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		regulator-always-on;
		regulator-boot-on;
	};

	vcc_phy: vcc-phy-regulator {
		compatible = "regulator-fixed";
		enable-active-high;
		gpio = <&gpio4 2 GPIO_ACTIVE_HIGH>;
		pinctrl-names = "default";
		pinctrl-0 = <&eth_phy_pwr>;
		regulator-name = "vcc_phy";
		regulator-min-microvolt = <1800000>;
		regulator-max-microvolt = <1800000>;
		regulator-always-on;
		regulator-boot-on;
	};

	misc-adv-gpio {
		compatible = "misc-adv-gpio";
		minipcie-pwr-gpio = <&gpio7 RK_PA6 GPIO_ACTIVE_HIGH>;
		timing-interval = <10>;
		minipcie-reset-gpio = <&gpio2 RK_PA7 GPIO_ACTIVE_LOW>;
		system-reset-gpio = <&gpio0 RK_PB2 GPIO_ACTIVE_LOW>;
		status = "okay";
		pinctrl-names = "default";
		pinctrl-0 = <&pcie_pwren &pcie_reset>;
	};
};

&cpu0 {
	cpu0-supply = <&vdd_cpu>;
};

&dfi {
	status = "okay";
};

&dmc {
	center-supply = <&vdd_log>;
	status = "okay";
};


&disp_timings {
	native-mode = <&edp_1920x1080>;
	native-edp-mode = <&edp_1920x1080>;
};

&edp {
    force-hpd;
    status = "okay";

    ports {
		edp_out: port@1 {
			reg = <1>;
			#address-cells = <1>;
			#size-cells = <0>;
			edp_out_panel: endpoint {
				reg = <0>;
				remote-endpoint = <&panel_in_edp>;
			};
		};
	};
};

&edp_phy {
    status = "okay";
};

&edp_in_vopb {
    status = "disabled";
};

&edp_in_vopl {
    status = "okay";
};

&hdmi_in_vopb {
    status = "okay";
};

&hdmi_in_vopl {
    status = "disabled";
};

&hdmi {
	#address-cells = <1>;
	#size-cells = <0>;
	#sound-dai-cells = <0>;
	status = "okay";
};

&vopb {
	status = "okay";
};

&vopb_mmu {
	status = "okay";
};

&vopl {
	status = "okay";
};

&vopl_mmu {
	status = "okay";
};
	
&saradc {
	vref-supply = <&vcc_18>;
	status = "okay";
};

&hevc_service {
	status = "okay";
};

&emmc {
	bus-width = <8>;
	cap-mmc-highspeed;
	disable-wp;
	non-removable;
	num-slots = <1>;
	pinctrl-names = "default";
	pinctrl-0 = <&emmc_clk &emmc_cmd &emmc_pwr &emmc_bus8>;
	max-frequency = <75000000>;
	mmc-hs200-1_8v;
	mmc-ddr-1_8v;
	status = "okay";
};

&sdmmc {
	supports-sd;
	bus-width = <4>;
	cap-mmc-highspeed;
	//sd-uhs-sdr12;
	//sd-uhs-sdr25;
	//sd-uhs-sdr50;
	//sd-uhs-sdr104;
	cap-sd-highspeed;
	card-detect-delay = <200>;
	disable-wp;			/* wp not hooked up */
	num-slots = <1>;
	pinctrl-names = "default";
	pinctrl-0 = <&sdmmc_clk &sdmmc_cmd &sdmmc_cd &sdmmc_bus4>;
	status = "okay";
	vmmc-supply = <&vcc_sd>;
	vqmmc-supply = <&vccio_sd>;
};

&sdio0 {
	status = "okay";
	max-frequency = <150000000>;

	bus-width = <4>;
	cap-sd-highspeed;
	//cap-sdio-irq;
	disable-wp;
	keep-power-in-suspend;
	mmc-pwrseq = <&sdio_pwrseq>;
	non-removable;
	num-slots = <1>;
	pinctrl-names = "default";
	pinctrl-0 = <&sdio0_bus4 &sdio0_cmd &sdio0_clk &sdio0_int>;
	//sd-uhs-sdr104;
	supports-sdio;
};

&gpu {
	status = "okay";
	mali-supply = <&vdd_gpu>;
};

&io_domains {
	status = "okay";
	audio-supply = <&vcca_18>;
	bb-supply = <&vcc_io>;
	dvp-supply = <&vcc_io>;
	flash0-supply = <&vcc_flash>;
	flash1-supply = <&vcc_phyio>;
	gpio30-supply = <&vcc_io>;
	gpio1830 = <&vcc_io>;
	lcdc-supply = <&vcca_33>;
	sdcard-supply = <&vccio_sd>;
	wifi-supply = <&vcc_io>;
};

&i2c0 {
	status = "okay";
	clock-frequency = <100000>;

	rk808: pmic@1b {
		compatible = "rockchip,rk808";
		reg = <0x1b>;
		interrupt-parent = <&gpio0>;
		interrupts = <4 IRQ_TYPE_LEVEL_LOW>;
		pinctrl-names = "default";
		pinctrl-0 = <&pmic_int &global_pwroff>;
		rockchip,system-power-controller;
		wakeup-source;
		#clock-cells = <1>;
		clock-output-names = "rk808-clkout1", "rk808-clkout2";

		vcc1-supply = <&vcc_sys>;
		vcc2-supply = <&vcc_sys>;
		vcc3-supply = <&vcc_sys>;
		vcc4-supply = <&vcc_sys>;
		vcc6-supply = <&vcc_sys>;
		vcc7-supply = <&vcc_sys>;
		vcc8-supply = <&vcc_io>;
		vcc9-supply = <&vcc_io>;
		vcc10-supply = <&vcc_io>;
		vcc11-supply = <&vcc_io>;
		vcc12-supply = <&vcc_io>;
		vddio-supply = <&vcc_io>;

		regulators {
			vdd_cpu: DCDC_REG1 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <700000>;
				regulator-max-microvolt = <1500000>;
				regulator-name = "vdd_arm";
				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			vdd_gpu: DCDC_REG2 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <900000>;
				regulator-max-microvolt = <1500000>;
				regulator-name = "vdd_gpu";
				regulator-ramp-delay = <6000>;
				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			vcc_ddr: DCDC_REG3 {
				regulator-always-on;
				regulator-boot-on;
				regulator-name = "vcc_ddr";
				regulator-state-mem {
					regulator-on-in-suspend;
				};
			};

			vcc_io: DCDC_REG4 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "vcc_io";
				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = <3300000>;
				};
			};

			vcc_flash_unused: LDO_REG1 {
				//regulator-always-on;
				//regulator-boot-on;
				regulator-min-microvolt = <1800000>;
				regulator-max-microvolt = <1800000>;
				regulator-name = "vcc_flash_unused";
				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			vcca_33: LDO_REG2 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <1800000>;
				regulator-init-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "vcca_33";
				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			vdd_10: LDO_REG3 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <1100000>;
				regulator-init-microvolt = <1100000>;
				regulator-max-microvolt = <1100000>;
				regulator-name = "vdd_10";
				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = <1100000>;
				};
			};

			vcca_18: LDO_REG4 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <1800000>;
				regulator-init-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "vcca_18";
				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			vccio_sd: LDO_REG5 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <1800000>;
				regulator-init-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "vccio_sd";
				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = <3300000>;
				};
			};

			vcc10_lcd: LDO_REG6 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <1100000>;
				regulator-init-microvolt = <1100000>;
				regulator-max-microvolt = <1100000>;
				regulator-name = "vcc10_lcd";
				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			vcc_18: LDO_REG7 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <1800000>;
				regulator-init-microvolt = <1800000>;
				regulator-max-microvolt = <1800000>;
				regulator-name = "vcc_18";
				regulator-state-mem {
					regulator-on-in-suspend;
					regulator-suspend-microvolt = <1800000>;
				};
			};

			vcc18_lcd: LDO_REG8 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <1800000>;
				regulator-init-microvolt = <1800000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "vcc18_lcd";
				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};

			vcc_sd: SWITCH_REG1 {
				regulator-always-on;
				regulator-boot-on;
				regulator-min-microvolt = <3300000>;
				regulator-init-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "vcc_sd";
				regulator-state-mem {
					regulator-on-in-suspend;
				};
			};

			phy_vddio_unused: SWITCH_REG2 {
				//regulator-always-on;
				//regulator-boot-on;
				regulator-min-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "phy_vddio_unused";
				regulator-state-mem {
					regulator-off-in-suspend;
				};
			};
		};
	};

	rtc0: rtc@30  {
		compatible = "s35390a"; 
		reg = <0x30>;
	};
};

&i2c1 {
	status = "okay";
	clock-frequency = <400000>;
};

&i2c2 {
	status = "okay";
	
	rt5660: rt5660@1c {
		#sound-dai-cells = <0>;
		compatible = "realtek,rt5660";
		rockchip,cru = <&cru>;
		rockchip,grf = <&grf>;
		reg = <0x1c>;
		codec-avdd-gpio = <&gpio3 10 GPIO_ACTIVE_LOW>;
		codec-avdd-delay = <100>;
		codec-micvdd-gpio = <&gpio3 11 GPIO_ACTIVE_HIGH>;
		codec-spkvdd-gpio = <&gpio3 12 GPIO_ACTIVE_HIGH>;
		amp-shutdown-gpio = <&gpio3 13 GPIO_ACTIVE_LOW>;
		amp-mute-gpio = <&gpio6 5 GPIO_ACTIVE_HIGH>;

		clocks = <&cru SCLK_I2S0_OUT>;
		clock-names = "mclk";
		interrupt-parent = <&gpio6>;
		interrupts = <7 IRQ_TYPE_EDGE_FALLING>;

		pinctrl-names = "default";
		pinctrl-0 = <&i2s0_mclk &codec_avdd &codec_micvdd &codec_spkvdd &amp_shutdown &amp_mute>;
	};
};

&i2c3 {
	status = "okay";

	camera0: camera-module@10 {
			status = "disabled";
	};
};

&i2c4 {
	status = "okay";
};

&i2c5 {
	status = "disabled";
};

&spi0 {
	status = "disabled";
	max-freq = <48000000>;	
};

&spi1 {
	status = "disabled";
	max-freq = <48000000>;
};

&spi2 {
	status = "okay";
	pinctrl-0 = <&spi2_clk &spi2_tx &spi2_rx &spi2_cs0 &spi2_cs1>;
	num-cs = <2>;
	max-freq = <48000000>;
	m25p80@0 {
		compatible = "w25q32";
		spi-max-frequency = <24000000>;
		reg = <0>;	/* CS address. */
		//spi-cpol;
		//spi-cpha;
	};
};

&i2s {
	status = "okay";
};

&vpu_service {
	status = "okay";
};

&cif_isp0 {
	rockchip,camera-modules-attached = <&camera0>;
	status = "disabled";
};

&isp_mmu {
	status = "okay";
};

&rga {
	status = "okay";
};

&usbphy {
	status = "okay";
};

&usb_host0_ehci {
	rockchip-relinquish-port;
	status = "okay";
};

&usb_host0_ohci {
	status = "okay";
};

&usb_host1 {
	status = "okay";
};

&usb_otg {
	status = "okay";
};

&uart0 {
	status = "okay";
	pinctrl-0 = <&uart0_xfer &uart0_cts>;
	dmas = <&dmac_peri 1>, <&dmac_peri 2>;
	dma-names = "tx", "rx";
};

&uart1 {
	status = "okay";
	pinctrl-names = "default","rts_gpio";
	pinctrl-0 = <&uart1_xfer &uart1_cts &uart1_rts>;
	pinctrl-1 = <&uart1_xfer &uart1_rts_gpio>;
	dmas = <&dmac_peri 3>, <&dmac_peri 4>;
	dma-names = "tx", "rx";
};

&uart2 {
	status = "okay";
	dmas = <&dmac_bus_s 4>, <&dmac_bus_s 5>;
	dma-names = "tx", "rx";
};

&uart3 {
	status = "okay";
	pinctrl-names = "default","rts_gpio";
	pinctrl-0 = <&uart3_xfer &uart3_cts &uart3_rts>;
	pinctrl-1 = <&uart3_xfer &uart3_rts_gpio>;
	dmas = <&dmac_peri 7>, <&dmac_peri 8>;
	dma-names = "tx", "rx";
};

&uart4 {
	status = "okay";
	pinctrl-names = "default","rts_gpio";
	pinctrl-0 = <&uart4_xfer &uart4_cts &uart4_rts &uart4_sel_gpio>;
	pinctrl-1 = <&uart4_xfer &uart4_sel_gpio &uart4_rts_gpio>;
	uart-sel-gpio = <&gpio5 RK_PC0 GPIO_ACTIVE_HIGH>;
	rs485-tx-active = <&gpio5 RK_PB5 GPIO_ACTIVE_LOW>;
	dmas = <&dmac_peri 9>, <&dmac_peri 10>;
	dma-names = "tx", "rx";
};

&gmac {
	status = "okay";
	phy-supply = <&vcc_phy>;
	phy-mode = "rgmii";
	clock_in_out = "input";
	snps,reset-gpio = <&gpio4 7 0>;
	snps,reset-active-low;
	snps,reset-delays-us = <0 1000 200000>;
	assigned-clocks = <&cru SCLK_MAC>;
	assigned-clock-parents = <&ext_gmac>;
	pinctrl-names = "default";
	pinctrl-0 = <&rgmii_pins &eth_phy_rst>;
	tx_delay = <0x0>;
	rx_delay = <0x0>;
	max-speed = <1000>;
	phy_reg_config = <//address mask value
					0x0014 0x200 0x200
					0x0018 0xfff 0x65b
					0x001e 0x200 0x200
					0x0032 0x3 0x3
					0x0086 0xff 0x80
					0x0170 0x1f00 0x0000
				>;
};

&wdt {
	status = "okay";
};

&cpu0_opp_table {
	/delete-node/ opp-126000000;
	/delete-node/ opp-216000000;
	/delete-node/ opp-696000000;
	/delete-node/ opp-1512000000;
};

&gpu_opp_table {
	/delete-node/ opp-100000000;
};

&tsadc {
	rockchip,grf = <&grf>;
	rockchip,hw-tshut-mode = <1>; /* tshut mode 0:CRU 1:GPIO */
	rockchip,hw-tshut-polarity = <0>; /* tshut polarity 0:LOW 1:HIGH */
	status = "okay";
};

&pinctrl {
	pcfg_pull_none_drv_8ma: pcfg-pull-none-drv-8ma {
		bias-disable;
		drive-strength = <8>;
	};

	pcfg_pull_up_drv_8ma: pcfg-pull-up-drv-8ma {
		bias-pull-up;
		drive-strength = <8>;
	};

	pcfg_pull_up_drv_2ma: pcfg-pull-up-drv-2ma {
		bias-pull-up;
		drive-strength = <2>;
	};
	
	pcfg_pull_down_drv_2ma: pcfg-pull-down-drv-2ma {
		bias-pull-down;
		drive-strength = <2>;
	};

	codec {
		codec_avdd: codec-avdd {
			rockchip,pins = <3 10 RK_FUNC_GPIO &pcfg_pull_up>;
		};
		codec_micvdd: codec-micvdd {
			rockchip,pins = <3 11 RK_FUNC_GPIO &pcfg_pull_down>;
		};
		codec_spkvdd: codec-spkvdd {
			rockchip,pins = <3 12 RK_FUNC_GPIO &pcfg_pull_down>;
		};
		amp_shutdown: amp-shutdown {
			rockchip,pins = <3 13 RK_FUNC_GPIO &pcfg_pull_up>;
		};
		amp_mute: amp-mute {
			rockchip,pins = <6 5 RK_FUNC_GPIO &pcfg_pull_down>;
		};
	};

	pmic {
		pmic_int: pmic-int {
			rockchip,pins = <0 4 RK_FUNC_GPIO &pcfg_pull_up>;
		};
		
		pmic_pwr: pmic-pwr {
			rockchip,pins = <0 5 RK_FUNC_GPIO &pcfg_pull_none>;
		};

		pmic_rst: pmic-rst {
			rockchip,pins = <0 10 RK_FUNC_GPIO &pcfg_pull_none>;
		};
	};

	sdmmc {
		/*
		 * Default drive strength isn't enough to achieve even
		 * high-speed mode on EVB board so bump up to 8ma.
		 */
		sdmmc_bus4: sdmmc-bus4 {
			rockchip,pins = <6 16 RK_FUNC_1 &pcfg_pull_up_drv_8ma>,
					<6 17 RK_FUNC_1 &pcfg_pull_up_drv_8ma>,
					<6 18 RK_FUNC_1 &pcfg_pull_up_drv_8ma>,
					<6 19 RK_FUNC_1 &pcfg_pull_up_drv_8ma>;
		};

		sdmmc_clk: sdmmc-clk {
			rockchip,pins = <6 20 RK_FUNC_1 &pcfg_pull_none_drv_8ma>;
		};

		sdmmc_cmd: sdmmc-cmd {
			rockchip,pins = <6 21 RK_FUNC_1 &pcfg_pull_up_drv_8ma>;
		};
	};

	usb {
		host_vbus_drv: host-vbus-drv {
			rockchip,pins = <0 14 RK_FUNC_GPIO &pcfg_pull_none>;
		};

		otg_vbus_drv: otg-vbus-drv {
			rockchip,pins = <0 12 RK_FUNC_GPIO &pcfg_pull_none>;
		};
	};

	eth-phy {
		eth_phy_pwr: eth-phy-pwr {
			rockchip,pins = <4 2 RK_FUNC_GPIO &pcfg_pull_none>;
		};

		eth_phy_rst: eth-phy-rst {
			rockchip,pins = <4 7 RK_FUNC_GPIO &pcfg_pull_none>;
		};
	};

	wireless-bluetooth {
		uart0_rts_gpio: uart0-rts-gpio {
			rockchip,pins = <4 19 RK_FUNC_GPIO &pcfg_pull_none>;
		};
		bt_pwr_h: bt-pwr-h {
			rockchip,pins =<5 17 RK_FUNC_GPIO &pcfg_pull_none>;
		};
	};
	
    sdio-pwrseq {
		wifi_enable_h: wifi-enable-h {
			rockchip,pins =<5 18 RK_FUNC_GPIO &pcfg_pull_none>; // WIFI_REG_ON
		};
		wifi_pwr_h: wifi-pwr-h {
			rockchip,pins =<4 28 RK_FUNC_GPIO &pcfg_pull_none>; // WIFI_REG_ON
		};
    };

    minipcie-pwrseq {
		pcie_pwren: pcie-pwren {
			rockchip,pins =<7 6 RK_FUNC_GPIO &pcfg_pull_none>;
		};

		pcie_reset: pcie-reset {
			rockchip,pins =<2 7 RK_FUNC_GPIO &pcfg_pull_none>;
		};
    };

	uart1_pin {
    	uart1_rts_gpio: uart1-rts-gpio {
			rockchip,pins =<3 19 RK_FUNC_GPIO &pcfg_pull_none>;
		};
    };
   
    uart3_pin {
    	uart3_rts_gpio: uart3-rts-gpio {
			rockchip,pins =<7 10 RK_FUNC_GPIO &pcfg_pull_none>;
		};
    };

    uart4_pin {
    	uart4_rts_gpio: uart4-rts-gpio {
			rockchip,pins =<5 13 RK_FUNC_GPIO &pcfg_pull_none>;
		};

		uart4_sel_gpio: uart4-sel-gpio {
			rockchip,pins =<5 16 RK_FUNC_GPIO &pcfg_pull_none>;
		};
    };

    spi2 {
		spi2_clk: spi2-clk {
			rockchip,pins = <8 6 RK_FUNC_1 &pcfg_pull_down_drv_2ma>;
		};
		spi2_cs0: spi2-cs0 {
			rockchip,pins = <8 7 RK_FUNC_1 &pcfg_pull_up_drv_2ma>;
		};
		spi2_rx: spi2-rx {
			rockchip,pins = <8 8 RK_FUNC_1 &pcfg_pull_down_drv_2ma>;
		};
		spi2_tx: spi2-tx {
			rockchip,pins = <8 9 RK_FUNC_1 &pcfg_pull_down_drv_2ma>;
		};
	};

	gmac {
		rgmii_pins: rgmii-pins {
			rockchip,pins = <3 30 3 &pcfg_pull_none_12ma>,
					<3 31 3 &pcfg_pull_none_12ma>,
					<3 26 3 &pcfg_pull_none_12ma>,
					<3 27 3 &pcfg_pull_none_12ma>,
					<3 28 3 &pcfg_pull_none_12ma>,
					<3 29 3 &pcfg_pull_none_12ma>,
					<3 24 3 &pcfg_pull_none_12ma>,
					<3 25 3 &pcfg_pull_none_12ma>,
					<4 0 3 &pcfg_pull_none_12ma>,
					<4 5 3 &pcfg_pull_none_12ma>,
					<4 6 3 &pcfg_pull_none_12ma>,
					<4 8 3 &pcfg_pull_none_12ma>,
					<4 9 3 &pcfg_pull_none_12ma>,
					<4 4 3 &pcfg_pull_none_12ma>,
					<4 1 3 &pcfg_pull_none_12ma>,
					<4 3 3 &pcfg_pull_none_12ma>;
		};
	};
};
